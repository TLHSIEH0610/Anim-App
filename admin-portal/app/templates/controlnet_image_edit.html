{% extends "base.html" %}

{% block content %}
<h2 class="mdc-typography--headline5">Edit Keypoint Image</h2>

<div class="mdc-card" style="margin-bottom:1.5rem; max-width:360px; padding:12px;">
  {% if image.image_path %}
    <img src="/files-proxy?path={{ image.image_path | urlencode }}" alt="{{ image.slug }}" style="width:100%; border-radius:10px; border:1px solid rgba(0,0,0,.12);">
  {% else %}
    <p><em>No image stored</em></p>
  {% endif %}
  <p style="margin-top:0.75rem;"><strong>Slug:</strong> <code>{{ image.slug }}</code></p>
  <p><strong>Name:</strong> {{ image.name }}</p>
  <p><strong>Updated:</strong> {{ image.updated_at or image.created_at or 'â€”' }}</p>
</div>

<form method="post" action="/keypoint-images/{{ image.slug }}" enctype="multipart/form-data" class="form-grid" style="margin-bottom:2rem;">
  <div>
    <label for="edit-slug">Slug</label>
    <input id="edit-slug" name="slug" value="{{ form_defaults.slug }}" required>
  </div>

  <div>
    <label for="edit-name">Name</label>
    <input id="edit-name" name="name" value="{{ form_defaults.name }}" required>
  </div>

  <div class="full">
    <label for="edit-file">Replace Image</label>
    <input id="edit-file" type="file" name="image_file" accept="image/*">
    <p style="font-size:0.85rem; opacity:.75;">Uploading a new file replaces the current keypoint mask after you save.</p>
  </div>

  <div class="form-actions full">
    <button type="submit" class="mdc-button mdc-button--raised"><span class="mdc-button__label">Save Changes</span></button>
  </div>
</form>

<form method="post" action="/keypoint-images/{{ image.slug }}/delete" onsubmit="return confirm('Delete keypoint image {{ image.slug }}?');" class="mt-2">
  <button type="submit" class="mdc-button mdc-button--outlined"><span class="mdc-button__label">Delete Keypoint Image</span></button>
</form>

<a href="/keypoint-images" class="mdc-button mt-4"><span class="mdc-button__label">Back to keypoints</span></a>
{% endblock %}
